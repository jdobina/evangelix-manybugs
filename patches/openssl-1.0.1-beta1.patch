--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -2419,7 +2419,7 @@
 			&s->s3->rrec.data[0], s->s3->rrec.length,
 			s, s->msg_callback_arg);
 
-	if (hbtype == TLS1_HB_REQUEST && 0 < 1)
+	if (((hbtype == 1) && ((payload + 18) < s->s3->rrec.length)))
 		{
 		unsigned char *buffer, *bp;
 		int r;
